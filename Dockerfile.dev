FROM node:current-alpine

# Install dotenvx CLI (from docs)
RUN apk add --no-cache curl && \
    curl -fsSL https://dotenvx.sh/install.sh | sh && \
    apk del curl  # Clean up

WORKDIR /app

# Copy package from src for dep caching
COPY ./package.json ./
RUN npm install

# Copy app code from src
COPY ./src .
COPY ./.env.local .env

EXPOSE 3000

# Default overridden by compose
CMD ["npm", "start"]