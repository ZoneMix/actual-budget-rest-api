authLogin:
  post:
    summary: Authenticate user
    description: |
      Authenticate with username/password or refresh token.
      
      **Rate Limited:** 5 requests per 15 minutes (strict limit for security)
      
      **Authentication Methods:**
      1. Username/Password: Returns access_token and refresh_token
      2. Refresh Token: Exchanges refresh_token for new access_token
    tags: [Authentication]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            oneOf:
              - type: object
                required: [username, password]
                properties:
                  username:
                    type: string
                    example: admin
                  password:
                    type: string
                    example: password123
              - type: object
                required: [refresh_token]
                properties:
                  refresh_token:
                    type: string
    responses:
      200:
        description: Authentication successful
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yml#/AuthTokens'
      400:
        description: Bad request (missing required fields)
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yml#/Error'
      401:
        description: Invalid credentials or expired refresh token
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yml#/Error'
      429:
        description: Rate limit exceeded (too many login attempts)
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yml#/Error'

authLogout:
  post:
    summary: Logout user and revoke tokens
    tags: [Authentication]
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [refresh_token]
            properties:
              refresh_token:
                type: string
    responses:
      200:
        description: Logout successful
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                message:
                  type: string

loginForm:
  get:
    summary: Display login form
    tags: [Authentication]
    parameters:
      - in: query
        name: return_to
        schema:
          type: string
      - in: query
        name: error
        schema:
          type: string
    responses:
      200:
        description: HTML login form
        content:
          text/html:
            schema:
              type: string
  post:
    summary: Process login form
    tags: [Authentication]
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required: [username, password]
            properties:
              username:
                type: string
              password:
                type: string
              return_to:
                type: string
    responses:
      302:
        description: Redirect after login
